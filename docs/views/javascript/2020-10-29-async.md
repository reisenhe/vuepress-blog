---
title: 【JavaScript】知识小记 - 异步
date: 2020-10-29
categories:
 - frontEnd
author: ReisenD
tags:
 - javascript
 - 面试
---

## 题目举例
1、同步和异步的区别
2、Promise 函数
3、实际开发中异步的应用场景

## 为什么需要异步
基于 js 是单线程语言，使用异步可以不阻塞代码继续执行下去，而是满足特定条件后执行 callback 函数
```js
console.log(100)
setTimeout(function () {
    // ← 这就是一个 callback 函数
    console.log(200)
}, 1000)
console.log(300)

// 100 300 200
```

## Promise
为了解决异步调用时，callback 函数层层嵌套的 callback hell，Promise 被开发了出来
```js
// 使用 Promise 加载一张图片
const url = 'https://reisenhe.github.io/img/bg.jpg'

function loadImg(src) {
    return new Promise((resolve, reject) => {
        const img = document.createElement('img')
        img.onload = () => {
            resolve(img)
        }
        img.onerror = () => {
            const error = new Error(`图片加载失败${src}`)
            reject(error)
        }
        img.src = src
    })
}

loadImg(url).then((img) => {
    console.log('加载完毕', img)
    // then 函数可以 return 一个普通变量，下一个 then 接收的参数便是该变量； 
    const text = '这是return的文字'
    return text
}).then(text => {
    console.log(text)
    // 也可以 return 一个 promise 对象，下一个 then 接收的参数将是这个 promise 所 resolve 的数据
    return loadImg(url)
}).then(img => {
    console.log('第二个图片', img)
}).catch(ex => console.error(ex))
```

## 异步的应用场景
1、发起网络请求时，等待媒体内容加载时
2、一些定时任务，例如 setTimeout