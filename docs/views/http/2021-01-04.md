---
title: 【HTTP】浏览器缓存
date: 2021-01-04
categories:
 - frontEnd
author: ReisenD
tags:
 - http
 - 面试
---

## 强制缓存
在 HTTP1.0 时期，使用的是 **Expires** 字段，会位于服务端返回的响应头 (response header) 中，记录下过期时间。等到过期时间到了，就会重新向服务器发起请求。  
Expires 存在问题，就是浏览器与服务器的时间可能并不一致

进入 HTTP1.1 时期，开始使用 **Cache-Control** 字段，它可能存在的值包括：  
max-age: 为缓存资源设置最大过期时间，例如下面这段，代表资源返回后6000秒内都可以继续使用缓存
```
Cache-Control: max-age=6000
```
no-cache: 不使用客户端缓存，下次继续照常请求  
no-store: 不适用客户端缓存，并且也不使用服务端缓存

如果没有命中强制缓存，就会进入协商缓存

## 协商缓存
在强制缓存过期失效后，浏览器将在请求头 (request header) 中带上响应的资源标识，由服务端通过判断它以决定是否返回新的资源。资源标识有两种类型字段，**Last-Modified** 与 **ETag**

在初次请求中，资源标识会由服务端与资源一并返回，标识存在于响应头中。浏览器获取了资源标识，记录，并在下次请求时发起，以供服务器判断是否缓存。  
**Last-Modified** 代表的是最后修改时间，再次请求时，请求头中的字段名为 **If-Modified-Since**。服务器将检查是否有新的修改时间，如果没有修改，返回 304，反之重新获取并更新标识。  
**ETag** 代表一个特别的值，再次请求时，请求头中的字段名为 **If-None-Match**。服务器将其与线上资源的 **ETag** 对比，相同时，返回 304，反之重新获取并更新。
:::tip
当两种方式同时使用时，服务器会优先考虑 ETag
:::